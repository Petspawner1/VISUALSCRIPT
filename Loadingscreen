local Players = game:GetService("Players")
local StarterGui = game:GetService("StarterGui")
local ContextActionService = game:GetService("ContextActionService")
local Lighting = game:GetService("Lighting")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")

local player = Players.LocalPlayer

-- ==== 1. PERMANENTLY DISABLE ROBLOX UI ====
StarterGui:SetCore("TopbarEnabled", false)
for _, coreType in ipairs(Enum.CoreGuiType:GetEnumItems()) do
    StarterGui:SetCoreGuiEnabled(coreType, false)
end

-- ==== 2. REMOVE RESET BUTTON ====
pcall(function()
    StarterGui:SetCore("ResetButtonCallback", false)
end)

-- ==== 3. BLOCK ESC & MENU BUTTONS FOREVER ====
local function blockMenu(_, _)
    return Enum.ContextActionResult.Sink
end
ContextActionService:BindAction("BlockMenuKeys", blockMenu, false, Enum.KeyCode.Escape, Enum.KeyCode.ButtonStart)

-- ==== 4. TEMPORARILY BLOCK ALL INPUT (During Loading) ====
local function blockAll(_, _)
    return Enum.ContextActionResult.Sink
end
ContextActionService:BindAction("BlockEverything", blockAll, false, unpack(Enum.PlayerActions:GetEnumItems()))

-- Blur Background
local blur = Instance.new("BlurEffect")
blur.Size = 24
blur.Parent = Lighting

-- ==== 5. LOADING GUI ====
local gui = Instance.new("ScreenGui")
gui.IgnoreGuiInset = true
gui.ResetOnSpawn = false
gui.Parent = player:WaitForChild("PlayerGui")

local overlay = Instance.new("Frame")
overlay.Size = UDim2.new(1, 0, 1, 0)
overlay.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
overlay.BackgroundTransparency = 0.4
overlay.BorderSizePixel = 0
overlay.Parent = gui

local box = Instance.new("Frame")
box.Size = UDim2.new(0, 300, 0, 150)
box.Position = UDim2.new(0.5, -150, 0.5, -75)
box.BackgroundColor3 = Color3.fromRGB(35, 35, 40)
box.BorderSizePixel = 0
box.Parent = overlay
Instance.new("UICorner", box).CornerRadius = UDim.new(0, 12)

local stroke = Instance.new("UIStroke")
stroke.Thickness = 3
stroke.Color = Color3.fromRGB(255, 0, 0)
stroke.Parent = box

local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, -20, 0.3, 0)
title.Position = UDim2.new(0, 10, 0, 10)
title.BackgroundTransparency = 1
title.Font = Enum.Font.GothamBold
title.TextScaled = true
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.Text = "Loading... 0%"
title.Parent = box

local barBg = Instance.new("Frame")
barBg.Size = UDim2.new(0.9, 0, 0.15, 0)
barBg.Position = UDim2.new(0.05, 0, 0.7, 0)
barBg.BackgroundColor3 = Color3.fromRGB(60, 60, 70)
barBg.BorderSizePixel = 0
barBg.Parent = box
Instance.new("UICorner", barBg).CornerRadius = UDim.new(0, 8)

local fill = Instance.new("Frame")
fill.Size = UDim2.new(0, 0, 1, 0)
fill.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
fill.BorderSizePixel = 0
fill.Parent = barBg
Instance.new("UICorner", fill).CornerRadius = UDim.new(0, 8)

-- ==== 6. ANIMATE 30s LOADING ====
local totalTime = 30
local startTime = tick()

while tick() - startTime < totalTime do
    local progress = math.min((tick() - startTime) / totalTime, 1)
    fill.Size = UDim2.new(progress, 0, 1, 0)
    title.Text = string.format("Loading... %d%%", math.floor(progress * 100))
    task.wait()
end

-- ==== 7. FADE OUT & UNBLOCK GAME INPUT ====
TweenService:Create(overlay, TweenInfo.new(0.5), {BackgroundTransparency = 1}):Play()
TweenService:Create(box, TweenInfo.new(0.5), {BackgroundTransparency = 1}):Play()
TweenService:Create(title, TweenInfo.new(0.5), {TextTransparency = 1}):Play()
task.wait(0.5)

blur:Destroy()
gui:Destroy()

-- Unblock gameplay controls but keep menu, chat, reset, leave blocked
ContextActionService:UnbindAction("BlockEverything")
